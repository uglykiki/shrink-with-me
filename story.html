<!DOCTYPE html>
<html lang="ENG">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrink with me</title>
	<script src="js/p5.min.js"></script>
	<script src="js/p5.js"></script>
	<script src="js/addons/p5.dom.js"></script>
	<script src="js/addons/p5.sound.js"></script>
	<script src="js/p5.speech.js"></script>
	<link rel="stylesheet" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Amatic+SC|Crimson+Text" rel="stylesheet">
</head>
<body class="page2">
<div class="live-story">
    <script>
        var songStress;
        var songRain;
        var songHelp;
        var songRun;
        var songKill;
        var songLaugh;
        var songBreath;
        var songCry;
        var myRec = new p5.SpeechRec('en-US', parseResult); // new P5.SpeechRec object
        myRec.continuous = true; // do continuous recognition
        myRec.interimResults = true; // allow partial recognition (faster, less accurate)
        var bg;
        
        // musics
        function preload() {
            songStress = loadSound('assets/The-Alchemist.mp3');
            songRain = loadSound('assets/rain.mp3');
            songHelp= loadSound('assets/help2.mp3');
            songRun = loadSound('assets/run.wav');
            songKill = loadSound('assets/kill.mp3');
            songBreath = loadSound('assets/breath.wav');
            songLaugh = loadSound('assets/laugh.wav');
            songCry = loadSound('assets/cry.wav');
        }
        
        function setup()
        {
            bg = loadImage("assets/breath.jpg");
            //loop song//
            songStress.loop(); 
            createCanvas(1260, 620);
            
            // instructions:
            background(bg);
            fill(255, 255, 255);
            textSize(20);
            textFont('Georgia');
            textAlign(LEFT);
            text("I'm so stressed,", 64, 40);
            
            //myRec.onResult = parseResult; // now in the constructor
            myRec.start(); // start engine
            songStress = loadSound ('assets/The-Alchemist.mp3');
        }
        
        
        function parseResult()
        {
            // recognition system will often append words into phrases.
            // so hack here is to only use the last word:
            var mostrecentword = myRec.resultString.split(' ').pop();
            if(mostrecentword.indexOf("stressed")!==-1) { 
                //text
                text("I hope some one can hear me,", 64, 74);
                //change soung
                songCry.play();
            }
            else if(mostrecentword.indexOf("hear")!==-1) { 
                text("Can anybody see the light? ", 64, 104);

            }
            else if(mostrecentword.indexOf("light")!==-1) { 
                text("Why it rains everyday?", 64, 134);
                songRain.play();
            }
            else if(mostrecentword.indexOf("everyday")!==-1) { 
                text("Why I can't breath normally?", 64, 164);
                
            }
            else if(mostrecentword.indexOf("breath")!==-1) { 
                text("I really really hate myself! ", 64, 194);
                songHelp.play();
                
            }
            else if(mostrecentword.indexOf("myself")!==-1) { 
                text("Sometimes I just want to escape...", 64, 224);
                songRun.play();
                
            }
            else if(mostrecentword.indexOf("escape")!==-1) { 
                text("have no reason", 64, 254);
            }
            else if(mostrecentword.indexOf("reason")!==-1) { 
                text("Or I want to destroy something ugly", 64, 284);
                songKill.play();
            }
            
            else if(mostrecentword.indexOf("ugly")!==-1) { 
                text("Like my hell life", 64, 314);
                songBreath.play();
            }
            
            else if(mostrecentword.indexOf("life")!==-1) { 
                text("It makes me feel relief.", 64, 344);
            }

            else if(mostrecentword.indexOf("relief")!==-1) { 
                text("Am I strange?", 64, 374);
                songLaugh.play();
                
            }
            else if(mostrecentword.indexOf("strange?")!==-1) { 
                text("Are you afraid of me", 64, 404);
            }
            else if(mostrecentword.indexOf("afraid")!==-1) { 
                text("Are you still listening?", 64, 434);
            }
        }
    </script>
</div>
<a class="leave" href="readme.html">leave</a>


</body>
</html>
